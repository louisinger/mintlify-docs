---
title: "Batch Outputs"
description: "Aggregating multiple transactions into coordinated Bitcoin outputs"
icon: "box-open"
---

A batch output is a single Bitcoin UTXO that contains multiple users' VTXOs. Instead of each user having their own onchain output, Arkade packs many ownership claims into one—dramatically reducing onchain footprint.

## Why Batching Matters

| Without Batching | With Batching |
|------------------|---------------|
| 100 users = 100 UTXOs | 100 users = 1 UTXO |
| 100 onchain transactions | 1 onchain transaction |
| Each pays full tx fee | Fee shared 100 ways |

This is how Arkade achieves low-cost settlement while maintaining individual exit rights.

## Batch Output Structure

A batch output is a Taproot output with:

| Component | Purpose |
|-----------|---------|
| **n-of-n MuSig2 key** | All VTXO owners + operator must sign for collaborative spend |
| **Unroll path** | Lets users split the batch into individual VTXO branches |
| **Sweep path** | Lets operator reclaim after [batch expiry](/learn/pillars/batch-expiry) |

The key path is unspendable—all spending goes through script paths.

## Virtual Transaction Tree

Inside a batch output, VTXOs are organized in a binary tree of presigned transactions:

<div style={{ display:"flex",justifyContent:"center" }}>
<img
  className="block dark:hidden"
  src="/images/ark/batchoutputlight.png"
  alt="Batch Outputs"
  style={{ width:"70%",height:"auto" }}
/>

</div>

<div style={{ display:"flex",justifyContent:"center" }}>
<img
  className="hidden dark:block mx-auto"
  src="/images/ark/batchoutputdark.png"
  alt="Batch Outputs"
  style={{ width:"70%",height:"auto" }}
/>

</div>

- **Root**: The batch output itself
- **Branches**: Intermediate virtual transactions
- **Leaves**: Individual VTXOs (A, B, C, D)

Each level can be "unrolled" by broadcasting the appropriate presigned transaction.

## Spending Paths

<div style={{ display:"flex",justifyContent:"center" }}>
<img
  className="block dark:hidden"
  src="/images/ark/conditionslight.png"
  alt="Spending Conditions"
  style={{ width:"70%",height:"auto" }}
/>

</div>

<div style={{ display:"flex",justifyContent:"center" }}>
<img
  className="hidden dark:block mx-auto"
  src="/images/ark/conditionsdark.png"
  alt="Spending Conditions"
  style={{ width:"70%",height:"auto" }}
/>

</div>

**Collaborative path**: All parties sign together. Used for normal batch swaps.

**Unroll path**: Any VTXO owner can broadcast their branch to extract their specific VTXO. Other users' VTXOs remain in the batch.

**Sweep path**: After expiry, operator can claim the entire output. Used to recycle liquidity from inactive VTXOs.

## Selective Unrolling

When you need to exit unilaterally, you only broadcast transactions along *your* path:

```
Batch Output
    └── Unroll to Branch A+B
            └── Unroll to VTXO A  ← Only these txs needed
```

Users C and D are unaffected—their VTXOs stay in the batch. This keeps costs low for everyone.

<Tip>
MuSig2 signature aggregation makes each virtual transaction appear as a single signature onchain, minimizing the size (and cost) of unroll transactions.
</Tip>

## Batch Lifecycle

1. **Created**: Operator constructs commitment transaction with batch output
2. **Active**: VTXOs are spendable offchain; users can exit via unroll path
3. **Expiring**: Users must [renew VTXOs](/learn/pillars/batch-expiry) before timeout
4. **Expired**: Operator sweeps remaining funds via sweep path

## Next Steps

<CardGroup cols={2}>
  <Card title="Batch Expiry" icon="hourglass-end" href="/learn/pillars/batch-expiry">
    Managing VTXO lifecycle and renewal
  </Card>
  <Card title="Batch Swaps" icon="rotate" href="/learn/pillars/batch-swaps">
    How to settle VTXOs into new batches
  </Card>
</CardGroup>
