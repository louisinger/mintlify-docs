---
title: "Lightning Swaps"
description: "Send and receive Lightning payments with your Arkade wallet"
icon: "bolt"
---

Exchange funds between Arkade and Lightning Network using submarine swaps powered by [Boltz](https://boltz.exchange). No channel management required.

## Why Use Lightning Swaps?

| Use Case | Method |
|----------|--------|
| **Fund your Arkade wallet** | Receive a Lightning payment → get VTXOs |
| **Pay Lightning invoices** | Spend VTXOs → pay any Lightning invoice |
| **Onboard new users** | Faster than [native boarding](/wallets/v0.3/ramps) for small amounts |

## Installation

```bash
npm install @arkade-os/sdk @arkade-os/boltz-swap
```

## Quick Start

```typescript
import { Wallet, SingleKey } from '@arkade-os/sdk'
import { ArkadeLightning, BoltzSwapProvider } from '@arkade-os/boltz-swap'

// Create your Arkade wallet
const wallet = await Wallet.create({
  identity: SingleKey.fromHex(privateKey),
  arkServerUrl: 'https://mutinynet.arkade.sh'
})

// Initialize Lightning provider
const swapProvider = new BoltzSwapProvider({
  apiUrl: 'https://api.testnet.boltz.exchange',  // Use mainnet URL for production
  network: 'testnet'
})

const lightning = new ArkadeLightning({ wallet, swapProvider })

// Receive from Lightning
const invoice = await lightning.createLightningInvoice({
  amount: 50000,
  description: 'Funding my Arkade wallet'
})
console.log('Pay this invoice:', invoice.invoice)

// Wait for payment and claim funds
const result = await lightning.waitAndClaim(invoice.pendingSwap)
console.log('Received! VTXO:', result.txid)
```

## Boltz API Endpoints

| Network | API URL |
|---------|---------|
| **Mainnet** | `https://api.ark.boltz.exchange` |
| **Testnet** | `https://api.testnet.boltz.exchange` |

## Receive Lightning Payments

Generate a Lightning invoice that deposits funds to your Arkade wallet:

```typescript
const invoice = await lightning.createLightningInvoice({
  amount: 50000,  // satoshis
  description: 'Payment for services'
})

console.log('Amount:', invoice.amount, 'sats')
console.log('Invoice:', invoice.invoice)
console.log('Expires in:', invoice.expiry, 'seconds')
```

Share the invoice with the payer. When paid, claim the funds:

```typescript
const result = await lightning.waitAndClaim(invoice.pendingSwap)
console.log('Funds received! Transaction:', result.txid)
```

<Tip>
`waitAndClaim` blocks until payment is received. For non-blocking flows, poll the swap status or use the storage provider to track pending swaps.
</Tip>

## Send Lightning Payments

Pay any Lightning invoice from your Arkade balance:

```typescript
import { decodeInvoice } from '@arkade-os/boltz-swap'

// Optional: decode invoice to inspect details
const details = decodeInvoice('lnbc500u1pj...')
console.log('Amount:', details.amountSats, 'sats')
console.log('Description:', details.description)

// Send the payment
const payment = await lightning.sendLightningPayment({
  invoice: 'lnbc500u1pj...',
  maxFeeSats: 1000  // optional fee limit
})

console.log('Paid! Preimage:', payment.preimage)
```

## Persistent Swap Storage

Track pending swaps across application restarts:

```typescript
import { StorageProvider } from '@arkade-os/boltz-swap'

const storageProvider = await StorageProvider.create({
  storagePath: './swaps.json'
})

const lightning = new ArkadeLightning({
  wallet,
  swapProvider,
  storageProvider
})

// Retrieve pending swaps on startup
const pendingReceives = lightning.getPendingReverseSwaps()
const pendingSends = lightning.getPendingSubmarineSwaps()

// Resume claiming any completed payments
for (const swap of pendingReceives) {
  try {
    await lightning.waitAndClaim(swap)
  } catch (e) {
    console.log('Swap not ready or expired:', swap.id)
  }
}
```

## Error Handling

```typescript
import {
  InsufficientFundsError,
  InvoiceExpiredError,
  SwapExpiredError,
  NetworkError
} from '@arkade-os/boltz-swap'

try {
  await lightning.sendLightningPayment({ invoice })
} catch (error) {
  if (error instanceof InsufficientFundsError) {
    console.error('Not enough funds:', error.message)
  } else if (error instanceof InvoiceExpiredError) {
    console.error('Invoice expired, request a new one')
  } else if (error instanceof SwapExpiredError) {
    // Attempt refund if possible
    if (error.isRefundable && error.pendingSwap) {
      const refund = await lightning.refundVHTLC(error.pendingSwap)
      console.log('Refunded:', refund.txid)
    }
  } else if (error instanceof NetworkError) {
    console.error('Network issue, retry later')
  } else {
    throw error
  }
}
```

## How Submarine Swaps Work

1. **Receive (Reverse Swap):** Boltz pays you onchain/Arkade when someone pays your Lightning invoice
2. **Send (Submarine Swap):** You pay Boltz, they pay the Lightning invoice

Both directions use atomic swaps with hash time-locked contracts (HTLCs), ensuring neither party can steal funds. If a swap fails, funds are automatically refundable after a timeout.

## Next Steps

<CardGroup cols={2}>
  <Card title="Chain Swaps" icon="link" href="/contracts/chain-swaps">
    Swap between Bitcoin chains
  </Card>
  <Card title="Ramps" icon="bitcoin" href="/wallets/v0.3/ramps">
    Native onchain boarding for larger amounts
  </Card>
</CardGroup>
